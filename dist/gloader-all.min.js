function createDFS(e,t,o){var n=[],r={};return function s(i){r[i]=!0,n.push(i),e[i].forEach(function(e){if(r[e]){if(n.indexOf(e)>=0)throw n.push(e),new Error("Dependency Cycle Found: "+n.join(" -> "))}else s(e)}),n.pop(),t&&0!==e[i].length||-1!==o.indexOf(i)||o.push(i)}}var DepGraph=function(){this.nodes={},this.outgoingEdges={},this.incomingEdges={}};"undefined"!=typeof exports&&(exports.DepGraph=DepGraph),DepGraph.prototype={addNode:function(e,t){this.hasNode(e)||(2===arguments.length?this.nodes[e]=t:this.nodes[e]=e,this.outgoingEdges[e]=[],this.incomingEdges[e]=[])},removeNode:function(e){this.hasNode(e)&&(delete this.nodes[e],delete this.outgoingEdges[e],delete this.incomingEdges[e],[this.incomingEdges,this.outgoingEdges].forEach(function(t){Object.keys(t).forEach(function(o){var n=t[o].indexOf(e);n>=0&&t[o].splice(n,1)},this)}))},hasNode:function(e){return this.nodes.hasOwnProperty(e)},getNodeData:function(e){if(this.hasNode(e))return this.nodes[e];throw new Error("Node does not exist: "+e)},setNodeData:function(e,t){if(!this.hasNode(e))throw new Error("Node does not exist: "+e);this.nodes[e]=t},addDependency:function(e,t){if(!this.hasNode(e))throw new Error("Node does not exist: "+e);if(!this.hasNode(t))throw new Error("Node does not exist: "+t);return-1===this.outgoingEdges[e].indexOf(t)&&this.outgoingEdges[e].push(t),-1===this.incomingEdges[t].indexOf(e)&&this.incomingEdges[t].push(e),!0},removeDependency:function(e,t){var o;this.hasNode(e)&&(o=this.outgoingEdges[e].indexOf(t))>=0&&this.outgoingEdges[e].splice(o,1),this.hasNode(t)&&(o=this.incomingEdges[t].indexOf(e))>=0&&this.incomingEdges[t].splice(o,1)},dependenciesOf:function(e,t){if(this.hasNode(e)){var o=[];createDFS(this.outgoingEdges,t,o)(e);var n=o.indexOf(e);return n>=0&&o.splice(n,1),o}throw new Error("Node does not exist: "+e)},dependantsOf:function(e,t){if(this.hasNode(e)){var o=[];createDFS(this.incomingEdges,t,o)(e);var n=o.indexOf(e);return n>=0&&o.splice(n,1),o}throw new Error("Node does not exist: "+e)},overallOrder:function(e){var t=this,o=[],n=Object.keys(this.nodes);if(0===n.length)return o;var r=createDFS(this.outgoingEdges,!1,[]);n.forEach(function(e){r(e)});var s=createDFS(this.outgoingEdges,e,o);return n.filter(function(e){return 0===t.incomingEdges[e].length}).forEach(function(e){s(e)}),o},steps:function(){var e=this,t=[],o={},n=function(r,s){var i,a,d,c,h,u=s+1;for(a=!0,d=0,c=e.incomingEdges[r].length;d<c;d++)i=e.incomingEdges[r][d],o.hasOwnProperty(i)?o[i]>u&&(u=o[i]+1):a=!1;if(a)for(t[u]||(t[u]=[]),t[u].push(r),o[r]=u,d=0,c=e.outgoingEdges[r].length;d<c;d++)h=e.outgoingEdges[r][d],n.call(e,h,u)};if((t=e.overallOrder()).length){t=[];for(var r in e.incomingEdges)e.incomingEdges.hasOwnProperty(r)&&(e.incomingEdges[r].length||n.call(e,r,-1))}return t}};var GLoader=function(){"use strict";this.graph=new DepGraph,this.validTypes=["js","css"]};"undefined"!=typeof exports&&(exports.GLoader=GLoader),GLoader.prototype={addScript:function(e,t){"use strict";return this.addResource(e,t,"js")},addStylesheet:function(e,t){"use strict";return this.addResource(e,t,"css")},addResource:function(e,t,o){"use strict";if(!e)throw new Error("id was empty");if("string"!=typeof e)throw new Error("id was not a string");if(!t)throw new Error("data was empty for script #"+e);if("object"!=typeof t)throw new Error("data was not an object for #"+e);if(!t.url||"string"!=typeof t.url)throw new Error("data.url was not a string for #"+e);if(t.fallback&&"string"!=typeof t.fallback)throw new Error("data.fallback was not a string for #"+e);if(!o)throw new Error("type cannot be empty for #"+e);if("string"!=typeof o)throw new Error("type was not a string for #"+e);if(-1==this.validTypes.indexOf(o))throw new Error("type was not a valid value for #"+e);return t.type=o,this.graph.addNode(e,t)},removeResource:function(e){"use strict";return this.graph.removeNode(e)},hasResource:function(e){"use strict";return this.graph.hasNode(e)},addDependency:function(e,t){"use strict";return this.graph.addDependency(e,t)},removeDependency:function(e,t){"use strict";return this.graph.removeDependency(idfrom,idto)},getData:function(e){"use strict";return console.log("getData with",e),this.graph.getNodeData(e)},loadResource:function(e){"use strict";console.log("loadResource with",e);var t=this;return new Promise(function(o,n){var r=t.getData(e),s=r.url,i=r.type;console.log("Chargement de "+i+" : "+s);var a,d,c=!1;"js"==i?(a=document.getElementsByTagName("script")[0],(d=document.createElement("script")).type="text/javascript",d.src=s,d.defer=!0):"css"==i&&((d=document.createElement("link")).type="text/css",d.rel="stylesheet",d.href=s),d.onload=d.onreadystatechange=function(){console.log(i+" s.onload "+s),c||this.readyState&&"complete"!=this.readyState||(c=!0,o(this),console.log("resolved : "+i+" "+s))},d.onerror=d.onabort=function(e){console.log("fallback pour "+r.cdn);var t=r.fallback,s=r.type;console.log("Chargement de "+s+" : "+t);var i,a,c=!1;"js"==s?(i=document.getElementsByTagName("script")[0],(a=document.createElement("script")).type="text/javascript",a.src=t,a.defer=!0):"css"==s&&((a=document.createElement("link")).type="text/css",a.rel="stylesheet",a.href=t),a.onload=d.onreadystatechange=function(){console.log(s+" s2.onload "+t),c||this.readyState&&"complete"!=this.readyState||(c=!0,o(this),console.log("resolved : "+s+" "+t))},a.onerror=a.onabort=n,"css"==s?document.body.appendChild(a):i.parentNode.insertBefore(a,i)},"css"==i?document.body.appendChild(d):a.parentNode.insertBefore(d,a)})},loadResources:function(e){"use strict";console.log("loadResources with",e);for(var t,o=this,n=[],r=0,s=e.length;r<s;r++)t=o.loadResource(e[r]),n.push(t);return Promise.all(n)},sequence:function(e,t){"use strict";var o=this;return e.reduce(function(e,n){return e.then(function(e,o){return console.log("resources step loaded!"),t(n)}.bind(o))}.bind(o),Promise.resolve())},load:function(){"use strict";var e=this,t=e.graph.steps();if(!t||!Array.isArray(t)||!t.length)throw new Error("nothing to load");return e.sequence(t,e.loadResources.bind(e)).then(function(e,t){console.log("jquery et bootstrap prêts !")},function(e){console.log("problème !",e)})}};